{"version":3,"file":"bundle.js","sources":["../js/helper.js","../js/shared.js","../js/userProfileSection/userProfileSection.js","../js/contributors/contributors.js","../js/profileForm/main.js","../js/admin/admin.js","../js/aceInitialized.js","../js/handleClientMessage.js","../js/syncData.js","../js/postAceInit.js"],"sourcesContent":["const __LOGIN = '2';\nconst __LOGOUT = '1';\n\n\n// const checkNotificationPermission = () => {\n//   if (!('Notification' in window)) {\n//     $.gritter.add({\n//       title: 'Error',\n//       text: 'ep_profile_modal: This browser does not support desktop notification.',\n//       sticky: true,\n//       // eslint-disable-next-line camelcase\n//       class_name: 'error',\n//     });\n//   } else if (!['denied', 'granted'].includes(Notification.permission)) {\n//     Notification.requestPermission().then((permission) => {\n//       console.log(permission, '<= permission');\n//     });\n//   }\n// };\n\nexport const userLogin = (data) => {\n  window.userStatus = 'login';\n  clientVars.ep_profile_modal.userStatus = __LOGIN;\n\n  pad.collabClient.updateUserInfo({\n    userId: pad.getUserId(),\n    name: data.username,\n    colorId: '#b4b39a',\n  });\n};\nexport const userLogout = () => {\n  window.userStatus = 'logout';\n  clientVars.ep_profile_modal.userStatus = __LOGOUT;\n\n  pad.collabClient.updateUserInfo({\n    userId: pad.getUserId(),\n    name: 'Anonymous',\n    colorId: '#b4b39a',\n  });\n};\nexport const logoutCssFix = (userId) => {\n  const avatar = $(`.avatarImg[data-id=\"user_${userId}\"]`);\n  if (avatar.length) {\n    avatar.css({'margin': '0px', 'box-shadow': 'none'});\n  }\n};\nexport const refreshUserImage = (userId, padId) => {\n  const imageUrl = `/static/getUserProfileImage/${userId}/${padId}?t=${new Date().getTime()}`;\n  const avatar = $(`.avatarImg[data-id=\"user_${userId}\"]`);\n  if (avatar.length) {\n    avatar.css({\n      'background-position': '50% 50%',\n      'background-image': `url(${imageUrl})`,\n      'background-repeat': 'no-repeat',\n      'background-size': '28px',\n      'background-color': '#fff',\n    });\n  }\n  $('.ep_profile_modal_section_image_big_ask').css({\n    'background-position': '50% 50%',\n    'background-image': `url(${imageUrl})`,\n    'background-repeat': 'no-repeat',\n  });\n  $('.ep_profile_modal_section_image_big').css({\n    'background-position': '50% 50%',\n    'background-image': `url(${imageUrl})`,\n    'background-repeat': 'no-repeat',\n    'background-size': '72px',\n  });\n  $('#ep-profile-image').css({\n    'background-position': '50% 50%',\n    'background-image': `url(${imageUrl})`,\n    'background-repeat': 'no-repeat',\n    'background-size': '32px',\n  });\n\n  const userSelector = $(\n      `.ep_profile_user_row[data-id=\"user_list_${userId}\"]`\n  );\n  if (userSelector.length) {\n    userSelector.children('.ep_profile_user_img').css({\n      'background-position': '50% 50%',\n      'background-image': `url(${imageUrl})`,\n      'background-repeat': 'no-repeat',\n      'background-size': '69px',\n    });\n  }\n\n  const rocketChatOnlineUser = $(`.avatar[data-id=\"${userId}\"]`);\n  if (rocketChatOnlineUser.length) {\n    rocketChatOnlineUser\n        .children('.ep_rocketchat_onlineUsersList_avatarImg')\n        .css({\n          'background-position': '50% 50%',\n          'background-image': `url(${imageUrl})`,\n          'background-repeat': 'no-repeat',\n          'background-size': '28px',\n        });\n  }\n};\n\nexport const refreshLoadingImage = (userId, padId) => {\n  const imageUrl =\n    '../static/plugins/ep_profile_modal/static/dist/img/loading.gif';\n  const avatar = $(`.avatarImg[data-id=\"user_${userId}\"]`);\n  if (avatar.length) {\n    avatar.css({\n      'background-position': '50% 50%',\n      'background-image': `url(${imageUrl})`,\n      'background-repeat': 'no-repeat',\n      'background-size': '28px',\n      'background-color': '#fff',\n    });\n  }\n  $('.ep_profile_modal_section_image_big_ask').css({\n    'background-position': '50% 50%',\n    'background-image': `url(${imageUrl})`,\n    'background-repeat': 'no-repeat',\n  });\n  $('.ep_profile_modal_section_image_big').css({\n    'background-position': '50% 50%',\n    'background-image': `url(${imageUrl})`,\n    'background-repeat': 'no-repeat',\n    'background-size': '72px',\n  });\n  $('#ep-profile-image').css({\n    'background-position': '50% 50%',\n    'background-image': `url(${imageUrl})`,\n    'background-repeat': 'no-repeat',\n    'background-size': '32px',\n  });\n\n  const userSelector = $(\n      `.ep_profile_user_row[data-id=\"user_list_${userId}\"]`\n  );\n  if (userSelector.length) {\n    userSelector.children('.ep_profile_user_img').css({\n      'background-position': '50% 50%',\n      'background-image': `url(${imageUrl})`,\n      'background-repeat': 'no-repeat',\n      'background-size': '69px',\n    });\n  }\n};\n\nexport const refreshGeneralImage = (userId, padId) => {\n  const imageUrl = `/static/getUserProfileImage/${userId}/${padId}?t=${new Date().getTime()}`;\n  const avatar = $(`.avatarImg[data-id=\"user_${userId}\"]`);\n  if (avatar.length) {\n    avatar.css({\n      'background-position': '50% 50%',\n      'background-image': `url(${imageUrl})`,\n      'background-repeat': 'no-repeat',\n      'background-size': '28px',\n      'background-color': '#fff',\n    });\n  }\n  const userSelector = $(\n      `.ep_profile_user_row[data-id=\"user_list_${userId}\"]`\n  );\n  if (userSelector.length) {\n    userSelector.children('.ep_profile_user_img').css({\n      'background-position': '50% 50%',\n      'background-image': `url(${imageUrl})`,\n      'background-repeat': 'no-repeat',\n      'background-size': '69px',\n    });\n  }\n};\n","import * as helper from './helper';\nconst __LOGIN = '2';\n\nexport const resetAllProfileImage = (userId, padId) => {\n  $.ajax({\n    url: `/static/${padId}/pluginfw/ep_profile_modal/resetProfileImage/${userId}`,\n    type: 'get',\n    data: {},\n    contentType: false,\n    processData: false,\n    beforeSend: () => {\n      helper.refreshLoadingImage(userId, padId);\n    },\n    error: (xhr) => {\n      // if error occured\n      helper.refreshUserImage(userId, padId);\n    },\n    success: (response) => {\n      helper.refreshUserImage(userId, padId);\n    },\n  });\n};\n\nexport const sendSignOutMessage = (userId, padId) => {\n  const message = {\n    type: 'ep_profile_modal',\n    action: 'ep_profile_modal_send_signout_message',\n    userId,\n    padId,\n  };\n  pad.collabClient.sendMessage(message); // Send the chat position message to the server\n};\n\nexport const scrollDownToLastChatText = (selector) => {\n  const $element = $(selector);\n  if ($element.length <= 0 || !$element[0]) return true;\n  $element.animate(\n      {scrollTop: $element[0].scrollHeight},\n      {duration: 400, queue: false}\n  );\n};\n\nexport const addTextChatMessage = (msg) => {\n  const authorClass = `author-${msg.userId.replace(/[^a-y0-9]/g, (c) => {\n    if (c === '.') return '-';\n    return `z${c.charCodeAt(0)}z`;\n  })}`;\n\n  // create the time string\n  let minutes = `${new Date(msg.time).getMinutes()}`;\n  let hours = `${new Date(msg.time).getHours()}`;\n  if (minutes.length === 1) minutes = `0${minutes}`;\n  if (hours.length === 1) hours = `0${hours}`;\n  const timeStr = `${hours}:${minutes}`;\n\n  const html = `<p><span class='time ${authorClass}'>${timeStr}</span> ${msg.text}</p>`;\n\n  $(document).find('#chatbox #chattext').append(html);\n  scrollDownToLastChatText('#chatbox #chattext');\n};\n\nexport const loginByEmailAndUsernameWithoutValidation = (\n  username,\n  email,\n  suggestData\n) => {\n  clientVars.ep_profile_modal.userStatus = __LOGIN;\n\n  window.userStatus = 'login';\n  const message = {\n    type: 'ep_profile_modal',\n    action: 'ep_profile_modal_login',\n    email,\n    userId: pad.getUserId(),\n    name: username,\n    padId: pad.getPadId(),\n    suggestData,\n  };\n  pad.collabClient.sendMessage(message); // Send the chat position message to the server\n};\n\nexport const isEmail = (email) => {\n  const regex =\n    /^([a-zA-Z0-9_.+-])+\\@(([a-zA-Z0-9-])+\\.)+([a-zA-Z0-9]{2,4})+$/;\n  if (email === '') {\n    return true;\n  } else {\n    return regex.test(email);\n  }\n};\n\nexport const loginByEmailAndUsername = (username, email) => {\n  if (username === '' || !isEmail(email)) {\n    if (!isEmail(email)) {\n      $('#ep_profile_modal_email').focus();\n      $('#ep_profile_modal_email').addClass(\n          'ep_profile_modal_validation_error'\n      );\n    }\n    return false;\n  } else {\n    $('#ep_profile_modal_email').removeClass(\n        'ep_profile_modal_validation_error'\n    );\n    clientVars.ep_profile_modal.userStatus = __LOGIN;\n\n    window.userStatus = 'login';\n    const message = {\n      type: 'ep_profile_modal',\n      action: 'ep_profile_modal_login',\n      email,\n      userId: pad.getUserId(),\n      name: username,\n      padId: pad.getPadId(),\n      suggestData: false,\n    };\n    pad.collabClient.sendMessage(message); // Send the chat position message to the server\n    helper.userLogin({\n      email,\n      username,\n    });\n\n    $('#online_ep_profile_modal_status').show();\n    $('#offline_ep_profile_modal_status').hide();\n  }\n};\n\nexport const isValid = (url) => {\n  const pattern =\n    // eslint-disable-next-line max-len\n    /^(http:\\/\\/www\\.|https:\\/\\/www\\.|http:\\/\\/|https:\\/\\/)?[a-z0-9]+([\\-\\.]{1}[a-z0-9]+)*\\.[a-z]{2,5}(:[0-9]{1,5})?(\\/.*)?$/;\n  return pattern.test(url);\n};\n\nexport const getFormData = ($form) => {\n  const unindexedArray = $form.serializeArray();\n  const indexedArray = {};\n\n  $.map(unindexedArray, (n, i) => {\n    indexedArray[n.name] = n.value;\n  });\n\n  return indexedArray;\n};\n\nexport const setFormData = ($form, indexedArray) => {\n  $.map(indexedArray, (n, i) => {\n    $(`#${i}`).val(n);\n  });\n};\n\nexport const isUsername = (username) => {\n  const regex = /^([a-zA-Z0-9_.+-])/;\n  return regex.test(username);\n};\n\nexport const showGeneralOverlay = () => {\n  $('#ep_profile_general_overlay').addClass(\n      'ep_profile_formModal_overlay_show'\n  );\n  $('#ep_profile_general_overlay').css({display: 'block'});\n};\n\nexport const hideGeneralOverlay = () => {\n  $('#ep_profile_general_overlay').removeClass(\n      'ep_profile_formModal_overlay_show'\n  );\n  $('#ep_profile_general_overlay').css({display: 'none'});\n  $('#ep_profile_modal').removeClass('ep_profile_modal-show');\n  $('#ep_profile_modal_user_list').removeClass('ep_profile_modal-show');\n  $('#ep_profile_users_profile').removeClass('ep_profile_formModal_show');\n};\n\nexport const getValidUrl = (url) => {\n  if (url === '' || !url) return '';\n  let newUrl = window.decodeURIComponent(url);\n  newUrl = newUrl.trim().replace(/\\s/g, '');\n\n  if (/^(:\\/\\/)/.test(newUrl)) {\n    return `http${newUrl}`;\n  }\n  if (!/^(f|ht)tps?:\\/\\//i.test(newUrl)) {\n    return `http://${newUrl}`;\n  }\n\n  return newUrl;\n};\n\nexport const getMonthName = (monthNumber) => {\n  const months = [\n    'January',\n    'February',\n    'March',\n    'April',\n    'May',\n    'June',\n    'July',\n    'August',\n    'September',\n    'October',\n    'November',\n    'December',\n  ];\n  return months[monthNumber - 1];\n};\n\nexport const getCustomeFormatDate = (date) => {\n  if (date === 'today' || date === 'yesterday') return `Last seen ${date}`;\n  date = date.split('-');\n  return `Last seen ${date[2]} ${getMonthName(date[1])} ${date[0]}`;\n};\n\nexport const getCustomDate = (date) => {\n  console.log(date, 'date');\n  if (date === 'today' || date === 'yesterday') return `Last seen ${date}`;\n  date = date.split('-');\n  return `Last seen ${date[2]}/${date[1]}/${date[0]}`;\n};\n","import * as shared from '../shared';\n\nexport const initiate = (clientVars) => {\n  const modal = $('#ep_profile_users_profile_script').tmpl(clientVars);\n  $('body').append(modal);\n  // $('#ep_profile_users_profile').addClass('ep_profile_formModal_show')\n};\n\nexport const initiateListeners = () => {\n  const avatarListerner = (userId) => {\n    const padId = pad.getPadId();\n    $.ajax({\n      url: `/static/${padId}/pluginfw/ep_profile_modal/getUserInfo/${userId}`,\n      type: 'get',\n      data: {},\n      contentType: false,\n      processData: false,\n      beforeSend: () => {\n        const imageUrl =\n          '../static/plugins/ep_profile_modal/static/dist/img/loading.gif';\n        $('#ep_profile_users_profile_userImage').css({\n          'background-position': '50% 50%',\n          'background-image': `url(${imageUrl})`,\n          'background-repeat': 'no-repeat',\n          'background-size': '69px',\n        });\n        // $('#ep_profile_users_profile').removeClass('ep_profile_formModal_show');\n        $('#ep_profile_user_img').css({\n          'background-position': '50% 50%',\n          'background-image': `url(${imageUrl})`,\n          'background-repeat': 'no-repeat',\n          'background-size': '69px',\n        });\n        $('#ep_profile_users_profile_name').text('');\n        $('#ep_profile_users_profile_desc').text('');\n\n        $('#ep_profile_users_profile').addClass('ep_profile_formModal_show');\n        shared.showGeneralOverlay();\n      },\n      error: (xhr) => {\n        // if error occured\n        $('#ep_profile_users_profile').removeClass(\n            'ep_profile_formModal_show'\n        );\n        shared.hideGeneralOverlay();\n      },\n      success: (response) => {\n        const imageUrl =\n          `/static/getUserProfileImage/${userId}/${padId}?t=${new Date().getTime()}`;\n        let username = response.user.username;\n        if (username == null || username === '') {\n          username = 'Anonymous';\n        }\n        const about = response.user.about || '';\n        const homepage = response.user.homepage || '';\n\n        $('#ep_profile_users_profile_name').text(username);\n        $('#ep_profile_users_profile_desc').text(about);\n        if (homepage === '') {\n          $('#ep_profile_users_profile_homepage').hide();\n        } else {\n          $('#ep_profile_users_profile_homepage').attr({\n            href: shared.getValidUrl(homepage),\n            target: '_blank',\n          });\n        }\n\n        $('#ep_profile_users_profile_userImage').css({\n          'background-position': '50% 50%',\n          'background-image': `url(${imageUrl})`,\n          'background-repeat': 'no-repeat',\n          'background-size': '69px',\n        });\n        $('#ep_profile_user_img').css({\n          'background-position': '50% 50%',\n          'background-image': `url(${imageUrl})`,\n          'background-repeat': 'no-repeat',\n          'background-size': '69px',\n        });\n      },\n    });\n  };\n\n  $('#usersIconList').on('avatarClick', (e, userIdParam) => {\n    // coming from external plugins\n    if (!userIdParam || userIdParam.indexOf('a.') < 0) return;\n    avatarListerner(userIdParam);\n  });\n\n  $('#usersIconList').on('click', '.avatar', function () {\n    const userId = $(this).attr('data-userId');\n    avatarListerner(userId);\n  });\n\n  $('#ep_profile_users_profile_close').on('click', () => {\n    $('#ep_profile_users_profile').removeClass('ep_profile_formModal_show');\n    shared.hideGeneralOverlay();\n  });\n};\n","import * as shared from '../shared';\n\nconst defaultImg =\n  '../static/plugins/ep_profile_modal/static/dist/img/user.png';\n\n\nexport const createHTMLforUserList = (total, online, padId, userVerify) => {\n  // generate avatar too\n  let html = \"<div id='usersIconList' class='ep_profile_inlineAvatars'>\";\n  let style;\n  let borderStyle = '';\n  $.each(online.reverse(), (key, value) => {\n    style = `background: url(/static/getUserProfileImage/${value.userId\n    }/${padId}) no-repeat 50% 50% ; background-size : 28px;background-color: #fff;`;\n    if (userVerify) {\n      borderStyle =\n        'box-shadow: 0px 0px 1px 1px rgba(38,121,255,1);margin: 1px;';\n    } else {\n      borderStyle = '';\n    }\n\n    style += borderStyle;\n    html += `<div class='avatar' data-userId=\"${value.userId}\" data-id=\"user_${value.userId\n    }\"  id=\"user_${value.userId}\" ><div data-userId=\"${value.userId\n    }\"  class='avatarImg' style='${style}' data-id=\"user_${value.userId}\"></div></div>`;\n  });\n  html += ' </div>';\n  return `${html}<span class='slash_profile'>⧸</span><span\n    id='userlist_count' class='userlist_count'>${total}</span> <input  value='Share'\n      id='ep_profile_modal_share' type='button' class='ep_profile_modal_share'>`;\n};\n\nexport const increaseUserFromList = (userId, padId) => {\n  const style = `background: url(/static/getUserProfileImage/${userId}/${padId\n  }) no-repeat 50% 50% ; background-size : 26px;background-color: #fff;`;\n\n  if (!$(`.avatar[data-id=\"user_${userId}\"]`).length) {\n    const $image = $(\n        `<div class='avatar' data-userId=\"${userId}\"  data-id=\"user_${userId}\" id=\"user_${userId\n        }\" ><div class='avatarImg' data-userId=\"${userId}\"  data-id=\"user_${userId\n        }\" style='${style}'></div></div>`\n    );\n    $image.prependTo('#usersIconList');\n    $image.hide().slideDown(200);\n  }\n};\n\n// TODO: rewrite and use template\nconst getHtmlOfUsersList = (\n  userId,\n  username,\n  img,\n  anonymousHandler,\n  about,\n  homepage,\n  seenStatus\n) => {\n  about = about || '';\n  homepage = homepage || '';\n  let style;\n  if (anonymousHandler && username === 'Anonymous') {\n    style = `background: url(${img}) no-repeat 50% 50% ; background-size : 69px ;`;\n\n    return (\n      `<div data-user-ids='${userId}' data-anonymouseCount='1' data-id='user_list_${anonymousHandler}' class='ep_profile_user_row'>` +\n      `<div style='${style}' class='ep_profile_user_img' id='ep_profile_user_img'></div>` +\n      \"<div class='ep_profile_user_list_profile_userDesc'>\" +\n      `<div class='ep_profile_user_list_username'>\n        <div class='ep_profile_user_list_username_text' id='ep_profile_users_profile_name'>\n        ${username}\n        </div>` +\n      `<div class='ep_profile_contributor_status'>${seenStatus}</div>` +\n      '</div>' +\n      `<p class='ep_profile_user_list_profile_desc' id='ep_profile_users_profile_desc'>\n${about}</p>` +\n      '</div> </div>'\n    );\n  } else {\n    style = `background: url(${img}) no-repeat 50% 50% ; background-size : 69px ;`;\n    return (\n      `<div data-id='user_list_${userId}' class='ep_profile_user_row'>` +\n      `<div style='${style}' class='ep_profile_user_img'  id='ep_profile_user_img'></div>` +\n      \"<div class='ep_profile_user_list_profile_userDesc'>\" +\n      `<div class='ep_profile_user_list_username'>\n<div class='ep_profile_user_list_username_text' id='ep_profile_users_profile_name'>\n${username}</div>` +\n      `<a target='_blank' style='\n${homepage === '' ||\n        homepage === '#' ||\n        homepage === undefined ||\n        homepage == null\n        ? 'display : none'\n        : ''\n      }'  class='ep_profile_contributor_link_container' title='\n        ${shared.getValidUrl(homepage)}' href='${shared.getValidUrl(\n          homepage\n      )}'> </a>` +\n      `<div class='ep_profile_contributor_status'>${seenStatus}</div>` +\n      '</div>' +\n      `<p class='ep_profile_user_list_profile_desc' id='ep_profile_users_profile_desc'>\n        ${about}\n      </p>` +\n      '</div> </div>'\n    );\n  }\n};\n\nexport const increaseToOnlineAnonymous = (selectorOn, userId) => {\n  const anonymouseCount = selectorOn.attr('data-anonymouseCount');\n  const idsData = selectorOn.attr('data-user-ids');\n  const idsDataArray = idsData.split(',');\n  if (idsDataArray.indexOf(userId) === -1) {\n    idsDataArray.push(userId);\n    selectorOn.attr('data-user-ids', idsDataArray.join(','));\n    const newAnonymouseCount = parseInt(anonymouseCount) + 1;\n    selectorOn.attr('data-anonymouseCount', newAnonymouseCount);\n    selectorOn\n        .children('.ep_profile_user_list_profile_userDesc')\n        .children('.ep_profile_user_list_username')\n        .children('.ep_profile_user_list_username_text')\n        .text(`Anonymous ×${newAnonymouseCount}`);\n  }\n};\n\nexport const manageOnlineOfflineUsers = (\n  allUsersList,\n  onlineUsers,\n  currentUserId,\n  lastPage\n) => {\n  const onlineListSelector = $('#ep_profile_user_list_container');\n  const offlineListSelector = $('#ep_profile_user_list_container_off');\n  if (lastPage) {\n    $('#ep_profile_modal_load_more_contributors').css({display: 'none'});\n  } else {\n    $('#ep_profile_modal_load_more_contributors').css({display: 'block'});\n  }\n  // offline_list_selector.empty();\n  $.each(allUsersList, (key, value) => {\n    // if (value.userId != currentUserId){\n    const result = $.grep(onlineUsers, (e) => e.userId === value.userId);\n    if (result.length) {\n      // online\n      if (value.userName === 'Anonymous') {\n        const selectorOn = $(\n            '.ep_profile_user_row[data-id=\"user_list_on_Anonymous\"]'\n        );\n\n        if (selectorOn.length) {\n          increaseToOnlineAnonymous(selectorOn, value.userId);\n        } else {\n          const userListHtml = getHtmlOfUsersList(\n              value.userId,\n              value.userName,\n              value.imageUrl,\n              'on_Anonymous',\n              value.about,\n              value.homepage,\n              'Online'\n          );\n          onlineListSelector.append(userListHtml);\n        }\n        if (currentUserId === value.userId) {\n          $(\".ep_profile_user_row[data-id='user_list_on_Anonymous']\").css({\n            'margin-top': '28px',\n          });\n        }\n      } else {\n        if (\n          !$(`.ep_profile_user_row[data-id=\"user_list_${value.userId}\"]`)\n              .length\n        ) {\n          const userListHtml = getHtmlOfUsersList(\n              value.userId,\n              value.userName,\n              value.imageUrl,\n              false,\n              value.about,\n              value.homepage,\n              'Online'\n          );\n          try {\n            onlineListSelector.append(userListHtml);\n          } catch (error) {\n            console.log(error);\n          }\n        } else if (currentUserId === value.userId) {\n          $(\n              `.ep_profile_user_row[data-id=\"user_list_${value.userId}\"]`\n          ).prependTo(onlineListSelector);\n        } else {\n          $(\n              `.ep_profile_user_row[data-id=\"user_list_${value.userId}\"]`\n          ).appendTo(onlineListSelector);\n        }\n        if (currentUserId === value.userId) {\n          $(`.ep_profile_user_row[data-id=\"user_list_${value.userId}\"]`).css({\n            'margin-top': '28px',\n          });\n        }\n      }\n    }\n    // offline\n    if (value.lastSeenDate !== '') {\n      if (value.userName !== 'Anonymous') {\n        if (\n          !$(`.ep_profile_user_row[data-id=\"user_list_${value.userId}\"]`)\n              .length\n        ) {\n          console.log('value', value);\n          const userListHtml = getHtmlOfUsersList(\n              value.userId,\n              value.userName,\n              value.imageUrl,\n              false,\n              value.about,\n              value.homepage,\n              shared.getCustomDate(value.lastSeenDate)\n          );\n          const offlinesDateSelector = $('#ep_profile_user_list_offline');\n          if (offlinesDateSelector.length) {\n            offlinesDateSelector.append(userListHtml);\n          } else {\n            $('#ep_profile_user_list_container_off').append(\n                `<div class='ep_profile_user_list_date_title' id='ep_profile_user_list_offline'>\n                ${userListHtml}</div>`\n            );\n          }\n        } else {\n          $(\n              `.ep_profile_user_row[data-id=\"user_list_${value.userId}\"]`\n          ).appendTo(offlineListSelector);\n        }\n      }\n    }\n\n    // }\n  });\n\n  // just for anonymouse to be end of list\n  $.each(allUsersList, (key, value) => {\n    // if (value.userId != currentUserId){\n    const result = $.grep(onlineUsers, (e) => e.userId === value.userId);\n    if (!result.length) {\n      // offline\n      if (value.userName === 'Anonymous') {\n        const selectorOff = $(\n            '.ep_profile_user_row[data-id=\"user_list_off_Anonymous\"]'\n        );\n        if (selectorOff.length) {\n          const anonymouseCount = selectorOff.attr('data-anonymouseCount');\n          const newAnonymouseCount = parseInt(anonymouseCount) + 1;\n\n          const idsDataOff = selectorOff.attr('data-user-ids');\n          const idsDataOffArray = idsDataOff.split(',');\n          idsDataOffArray.push(value.userId);\n          selectorOff.attr('data-user-ids', idsDataOffArray.join(','));\n\n          selectorOff.attr('data-anonymouseCount', newAnonymouseCount);\n          selectorOff\n              .children('.ep_profile_user_list_profile_userDesc')\n              .children('.ep_profile_user_list_username')\n              .text(`Anonymous ×${newAnonymouseCount}`);\n        } else {\n          const userListHtml = getHtmlOfUsersList(\n              value.userId,\n              'Anonymous',\n              value.imageUrl,\n              'off_Anonymous',\n              value.about,\n              value.homepage,\n              shared.getCustomDate(value.lastSeenDate)\n          );\n          const selectorOfflinesDate = $('#ep_profile_user_list_offline');\n          if (selectorOfflinesDate.length) {\n            selectorOfflinesDate.append(userListHtml);\n          } else {\n            $('#ep_profile_user_list_container_off').append(\n                `<div class='ep_profile_user_list_date_title' id='ep_profile_user_list_offline'>\n                ${userListHtml}</div>`\n            );\n          }\n        }\n      }\n    }\n  });\n};\n\nexport const decreaseFromOnlineAnonymous = (selectorOn, userId) => {\n  const anonymouseCount = selectorOn.attr('data-anonymouseCount');\n  const idsData = selectorOn.attr('data-user-ids');\n  let idsDataArray = idsData.split(',');\n\n  idsDataArray = $.grep(idsDataArray, (value) => value !== userId);\n\n  selectorOn.attr('data-user-ids', idsDataArray.join(','));\n  const newAnonymouseCount = parseInt(anonymouseCount) - 1;\n  selectorOn.attr('data-anonymouseCount', newAnonymouseCount);\n  if (newAnonymouseCount > 1) {\n    selectorOn\n        .children('.ep_profile_user_list_profile_userDesc')\n        .children('.ep_profile_user_list_username')\n        .children('.ep_profile_user_list_username_text')\n        .text(`Anonymous ×${newAnonymouseCount}`);\n  } else {\n    selectorOn\n        .children('.ep_profile_user_list_profile_userDesc')\n        .children('.ep_profile_user_list_username')\n        .children('.ep_profile_user_list_username_text')\n        .text('Anonymous');\n  }\n\n  if (newAnonymouseCount < 1) {\n    selectorOn.remove();\n  }\n  return newAnonymouseCount;\n};\n\nexport const increaseToOfflineAnonymous = (selectorOff, userId) => {\n  const anonymouseCount = selectorOff.attr('data-anonymouseCount');\n  let idsData = selectorOff.attr('data-user-ids');\n\n  idsData = $.grep(idsData, (value) => value !== userId);\n\n  selectorOff.attr('data-user-ids', idsData);\n  const newAnonymouseCount = parseInt(anonymouseCount) + 1;\n  selectorOff.attr('data-anonymouseCount', newAnonymouseCount);\n  selectorOff\n      .children('.ep_profile_user_list_profile_userDesc')\n      .children('.ep_profile_user_list_username')\n      .children('.ep_profile_user_list_username_text')\n      .text(`Anonymous ×${newAnonymouseCount}`);\n};\n\nexport const createOfflineAnonymousElement = (\n  userId,\n  img,\n  about,\n  homepage,\n  userElement\n) => {\n  const userListHtml = getHtmlOfUsersList(\n      userId,\n      'Anonymous',\n      img,\n      'off_Anonymous',\n      about,\n      homepage,\n      'Today'\n  );\n  const offlineListSelector = $('#ep_profile_user_list_offline');\n  if (offlineListSelector.length) {\n    // because need anonymous offline be last one\n    const userSelector = $(\n        \".ep_profile_user_row[data-id='user_list_off_Anonymous']\"\n    );\n    if (userSelector.length) {\n      userElement.insertBefore(userSelector);\n    } else {\n      offlineListSelector.append(userElement);\n    }\n  } else {\n    const offlineContainer = $('#ep_profile_user_list_container_off');\n    offlineContainer.prepend(\n        \"<div class='ep_profile_user_list_date_title' id='ep_profile_user_list_offline'></div>\"\n    );\n    offlineListSelector.append(userListHtml);\n  }\n};\n\nexport const createOnlineUserElementInUserList = (\n  userId,\n  userName,\n  img,\n  currentUserId,\n  user\n) => {\n  const userSelector = $(\n      `.ep_profile_user_row[data-id=\"user_list_${userId}\"]`\n  );\n  if (!userSelector.length) {\n    const userListHtml = getHtmlOfUsersList(\n        userId,\n        userName,\n        img,\n        false,\n        user.about,\n        user.homepage,\n        'Online'\n    );\n    if (userId === currentUserId) {\n      // it is owner\n      const titleOfContributors = $('#ep_profile_user_list_date_title');\n      if (titleOfContributors.length) {\n        $(userListHtml).insertAfter(titleOfContributors);\n      } else {\n        $('#ep_profile_user_list_container').prepend(userListHtml);\n      }\n    } else {\n      $('#ep_profile_user_list_container').append(userListHtml);\n    }\n  } else {\n    userSelector\n        .children('.ep_profile_user_list_profile_userDesc')\n        .children('.ep_profile_user_list_username')\n        .children('.ep_profile_user_list_username_text')\n        .text(userName);\n    userSelector.children('.ep_profile_user_img').css({\n      'background-position': '50% 50%',\n      'background-image': `url(${img})`,\n      'background-repeat': 'no-repeat',\n      'background-size': '69px',\n    });\n  }\n};\n\nexport const isThereOnlineAnonymous = () => {\n  const selector = $(\n      '.ep_profile_user_row[data-id=\"user_list_on_Anonymous\"]'\n  );\n  if (selector.length) {\n    return selector;\n  } else {\n    return false;\n  }\n};\n\nexport const checkUserExistInOnlineAnonymous = (selectorOn, userId) => {\n  const idsData = selectorOn.attr('data-user-ids');\n  const idsDataArray = idsData.split(',');\n  if (idsDataArray.indexOf(userId) === -1) {\n    return false;\n  } else {\n    return true;\n  }\n};\n\nexport const createOnlineAnonymousElement = (userId, userName, imageUrl, user) => {\n  const onlineListSelector = $('#ep_profile_user_list_container');\n  const userListHtml = getHtmlOfUsersList(\n      userId,\n      userName,\n      imageUrl,\n      'on_Anonymous',\n      user.about,\n      user.homepage,\n      'Online'\n  );\n  onlineListSelector.append(userListHtml);\n};\n\nexport const moveOnlineUserToOffline = (userElement) => {\n  const offlineListSelector = $('#ep_profile_user_list_offline');\n  if (offlineListSelector.length) {\n    // because need anonymous offline be last one\n    const userSelector = $(\n        \".ep_profile_user_row[data-id='user_list_off_Anonymous']\"\n    );\n    if (userSelector.length) {\n      userElement.insertBefore(userSelector);\n    } else {\n      offlineListSelector.append(userElement);\n    }\n  } else {\n    const offlineContainer = $('#ep_profile_user_list_container_off');\n    offlineContainer.prepend(\n        \"<div class='ep_profile_user_list_date_title' id='ep_profile_user_list_offline'></div>\"\n    );\n    offlineListSelector.append(userElement);\n  }\n\n  userElement\n      .children('.ep_profile_user_list_profile_userDesc')\n      .children('.ep_profile_user_list_username')\n      .children('.ep_profile_contributor_status')\n      .text('Last seen today');\n};\n\nexport const decreaseUserFromList = (userId, padId) => {\n  $(`.avatar[data-id=\"user_${userId}\"]`).animate(\n      {opacity: 0},\n      1000,\n      'linear',\n      function () {\n        $(this).remove();\n      }\n  );\n\n  const selectorUser = $(\n      `.ep_profile_user_row[data-id=\"user_list_${userId}\"]`\n  );\n  if (selectorUser.length) {\n    moveOnlineUserToOffline(selectorUser);\n  } else {\n    const selectorOn = $(\n        '.ep_profile_user_row[data-id=\"user_list_on_Anonymous\"]'\n    );\n    if (selectorOn.length) {\n      const selectorOff = $(\n          '.ep_profile_user_row[data-id=\"user_list_off_Anonymous\"]'\n      );\n      decreaseFromOnlineAnonymous(selectorOn, userId);\n      if (selectorOff.length) {\n        increaseToOfflineAnonymous(selectorOff, userId);\n      } else {\n        createOfflineAnonymousElement(\n            userId,\n            defaultImg,\n            null,\n            null,\n            selectorUser\n        );\n      }\n    } else {\n      let offlineListSelector = $('#ep_profile_user_list_offline');\n      if (offlineListSelector.length) {\n        offlineListSelector.append(\n            $(`.ep_profile_user_row[data-id=\"user_list_${userId}\"]`)\n        );\n      } else {\n        const offlineContainer = $('#ep_profile_user_list_container_off');\n        offlineContainer.prepend(\n            `<div class=\"ep_profile_user_list_date_title\"\n              id=\"ep_profile_user_list_offline\"></div>`\n        );\n        offlineListSelector = $('#ep_profile_user_list_offline');\n        $(`.ep_profile_user_row[data-id=\"user_list_${userId}\"]`).appendTo(\n            offlineListSelector\n        );\n      }\n    }\n  }\n\n  // user img update\n  const imageUrl = `/static/getUserProfileImage/${userId}/${padId}?t=${new Date().getTime()}`;\n  const userSelector = $(\n      `.ep_profile_user_row[data-id=\"user_list_${userId}\"]`\n  );\n  if (userSelector.length) {\n    userSelector.children('.ep_profile_user_img').css({\n      'background-position': '50% 50%',\n      'background-image': `url(${imageUrl})`,\n      'background-repeat': 'no-repeat',\n      'background-size': '69px',\n    });\n  }\n};\n\nexport const removeUserElementInUserList = (userId) => {\n  $(`.ep_profile_user_row[data-id=\"user_list_${userId}\"]`).remove();\n};\n\nexport const paginateContributors = (\n  allUsersList,\n  onlineUsers,\n  currentUserId,\n  lastPage\n) => {\n  const containerPaginationList = $(\n      '#ep_profile_user_list_container_pagination'\n  );\n  if (lastPage) {\n    $('#ep_profile_modal_load_more_contributors').css({display: 'none'});\n  }\n  $.each(allUsersList, (key, value) => {\n    const result = $.grep(onlineUsers, (e) => e.userId === value.userId);\n\n    if (value.lastSeenDate !== '' && value.userName !== 'Anonymous') {\n      const userListHtml = getHtmlOfUsersList(\n          value.userId,\n          value.userName,\n          value.imageUrl,\n          false,\n          value.about,\n          value.homepage,\n          result.length ? 'Online' : shared.getCustomDate(value.lastSeenDate)\n      );\n\n      containerPaginationList.append(userListHtml);\n    }\n\n    if (result.length) {\n      // online\n      if (value.userName === 'Anonymous') {\n        const selectorOn = $(\n            '.ep_profile_user_row[data-id=\"user_list_on_Anonymous\"]'\n        );\n\n        if (selectorOn.length) {\n          increaseToOnlineAnonymous(selectorOn, value.userId);\n        } else {\n          const userListHtml = getHtmlOfUsersList(\n              value.userId,\n              value.userName,\n              value.imageUrl,\n              'on_Anonymous',\n              value.about,\n              value.homepage,\n              'Online'\n          );\n          containerPaginationList.append(userListHtml);\n        }\n        if (currentUserId === value.userId) {\n          $(\".ep_profile_user_row[data-id='user_list_on_Anonymous']\").css({\n            'margin-top': '28px',\n          });\n        }\n      }\n    }\n  });\n\n  // just for anonymouse to be end of list\n  $.each(allUsersList, (key, value) => {\n    // if (value.userId != currentUserId){\n    const result = $.grep(onlineUsers, (e) => e.userId === value.userId);\n    if (!result.length) {\n      // offline\n      if (value.userName === 'Anonymous') {\n        const selectorOff = $(\n            '.ep_profile_user_row[data-id=\"user_list_off_Anonymous\"]'\n        );\n        if (selectorOff.length) {\n          const anonymouseCount = selectorOff.attr('data-anonymouseCount');\n          const newAnonymouseCount = parseInt(anonymouseCount) + 1;\n\n          const idsDataOff = selectorOff.attr('data-user-ids');\n          const idsDataOffArray = idsDataOff.split(',');\n          idsDataOffArray.push(value.userId);\n          selectorOff.attr('data-user-ids', idsDataOffArray.join(','));\n\n          selectorOff.attr('data-anonymouseCount', newAnonymouseCount);\n          selectorOff\n              .children('.ep_profile_user_list_profile_userDesc')\n              .children('.ep_profile_user_list_username')\n              .text(`Anonymous ×${newAnonymouseCount}`);\n        } else {\n          const userListHtml = getHtmlOfUsersList(\n              value.userId,\n              'Anonymous',\n              value.imageUrl,\n              'off_Anonymous',\n              value.about,\n              value.homepage\n          );\n          containerPaginationList.append(userListHtml);\n        }\n      }\n    }\n  });\n};\n","import * as shared from '../shared';\nimport * as helper from '../helper';\n\n\nexport const showModal = () => {\n  $('#ep_profile_formModal').addClass('ep_profile_formModal_show');\n  $('#ep_profile_formModal_overlay').addClass(\n      'ep_profile_formModal_overlay_show'\n  );\n  $('#ep_profile_formModal_overlay').css({display: 'block'});\n  setTimeout(() => {\n    $('#ep_profile_modalForm_name').focus();\n  }, 1000);\n};\n\nexport const allEventListener = () => {\n  const padOuter = $('iframe[name=\"ace_outer\"]').contents();\n  const padInner = padOuter.find('iframe[name=\"ace_inner\"]');\n  const innerdocbody = padInner.contents().find('#innerdocbody');\n\n  innerdocbody.on('keypress', (e) => {\n    showModal();\n  });\n  innerdocbody.on('mousedown', (event) => {\n    if (event.which === 1) {\n      showModal();\n    }\n  });\n};\n\nconst removeEventListener = () => {\n  const padOuter = $('iframe[name=\"ace_outer\"]').contents();\n  const padInner = padOuter.find('iframe[name=\"ace_inner\"]');\n  const innerdocbody = padInner.contents().find('#innerdocbody');\n  innerdocbody.off('keypress');\n  innerdocbody.off('mousedown');\n};\n\nexport const getFormData = ($form) => {\n  const unindexedArray = $form.serializeArray();\n  const indexedArray = {};\n\n  $.map(unindexedArray, (n, i) => {\n    indexedArray[n.name] = n.value;\n  });\n\n  return indexedArray;\n};\n\nexport const handleOnCloseOverlay = () => {\n  const userId = pad.getUserId();\n  const padId = pad.getPadId();\n  const $form = $('#ep_profile_formModal_msform');\n  const data = getFormData($form);\n  const msg = {};\n  localStorage.setItem('formPassed', 'yes');\n  removeEventListener();\n  if (\n    data.ep_profile_modalForm_name === '' ||\n    ['', null, undefined].includes(localStorage.getItem('formStatus'))\n  ) {\n    return false;\n  }\n  let text = `Please welcome ${data.ep_profile_modalForm_name}`;\n  if (data.ep_profile_modalForm_about_yourself !== '') {\n    text += `, ${data.ep_profile_modalForm_about_yourself}`;\n  }\n  if (data.ep_profile_modalForm_homepage !== '') {\n    const url = shared.getValidUrl(data.ep_profile_modalForm_homepage);\n    text += `, ${url}`;\n  }\n\n  msg.messageChatText = `${text}`;\n  msg.target = 'profile';\n  msg.userId = userId;\n  msg.time = new Date();\n\n  const message = {\n    type: 'ep_rocketchat',\n    action: 'ep_rocketchat_sendMessageToChat_login',\n    userId,\n    data: msg,\n    padId,\n  };\n  pad.collabClient.sendMessage(message); // Send the chat position message to the server\n\n  // Dispatch/Trigger/Fire the event\n  const eventData = {userId, padId, title: 'Welcome', body: text};\n  const event = new CustomEvent('ep_push_notification',\n      {detail: {eventName: 'notifyAll', data: eventData}});\n  window.dispatchEvent(event);\n};\n\nexport const hideFormModalOverlay = () => {\n  $('#ep_profile_formModal_overlay').removeClass(\n      'ep_profile_formModal_overlay_show'\n  );\n  $('#ep_profile_formModal_overlay').css({display: 'none'});\n\n  handleOnCloseOverlay();\n};\n\nexport const resetModal = () => {\n  const fieldsets = $('#ep_profile_formModal_msform fieldset');\n  fieldsets.each(function (index) {\n    if (index === 0) $(this).show();\n    else $(this).hide();\n  });\n};\n\nexport const initModal = (clientVars) => {\n  const modal = $('#ep_profile_formModal_script').tmpl(clientVars);\n  $('body').append(modal);\n\n  // jQuery time\n  let currentFs, nextFs, previousFs; // fieldsets\n  let animating; // flag to prevent quick multi-click glitches\n\n  $('.skip').click(function () {\n    if (animating) return false;\n    $('#ep_profile_modalForm_name').css({border: '1px solid gray'});\n\n    animating = true;\n\n    currentFs = $(this).parent();\n    nextFs = $(this).parent().next();\n\n    // activate next step on progressbar using the index of next_fs\n    // $(\"#progressbar li\").eq($(\"fieldset\").index(next_fs)).addClass(\"active\");\n\n    // show the next fieldset\n    currentFs.hide();\n    nextFs.show();\n    animating = false;\n  });\n\n  $(\n      '.close , #ep_profile_formModal_overlay , .ep_profile_formModal_topClose'\n  ).click(() => {\n    $('#ep_profile_formModal').removeClass('ep_profile_formModal_show');\n\n    hideFormModalOverlay();\n\n    return false;\n  });\n  $('.previous').click(function () {\n    if (animating) return false;\n    animating = true;\n\n    currentFs = $(this).parent();\n    previousFs = $(this).parent().prev();\n\n    // de-activate current step on progressbar\n    // $(\"#progressbar li\").eq($(\"fieldset\").index(current_fs)).removeClass(\"active\");\n    currentFs.hide();\n    previousFs.show();\n    animating = false;\n  });\n\n  $('.clear').click(function () {\n    shared.resetAllProfileImage(\n        $(this).attr('data-userId'),\n        $(this).attr('data-padId')\n    );\n  });\n\n  const sendFormDataToServer = () => {\n    const userId = pad.getUserId();\n    const padId = pad.getPadId();\n    const $form = $('#ep_profile_formModal_msform');\n    const data = getFormData($form);\n    // send to ep_push_notification\n    if (data.ep_profile_modalForm_push === 'Yes') {\n      const event = new CustomEvent('ep_push_notification',\n          {detail: {eventName: 'checkPermission'}});\n      // Dispatch/Trigger/Fire the event\n      window.dispatchEvent(event);\n    }\n    const message = {\n      type: 'ep_profile_modal',\n      action: 'ep_profile_modal_info',\n      userId,\n      data,\n      padId,\n    };\n    pad.collabClient.sendMessage(message); // Send the chat position message to the server\n  };\n\n  const sendEmailVerification = (email, username) => {\n    const oldText = $('#ep_profile_modal_verification').text();\n    $.ajax({\n      url: `/static/${pad.getPadId()}/pluginfw/ep_profile_modal/sendVerificationEmail/$\n        {pad.getUserId()}/${username}/${email}`,\n      type: 'get',\n      data: {},\n      contentType: false,\n      processData: false,\n      beforeSend: () => {\n        // setting a timeout\n        $('#ep_profile_modal_verification').text('Sending...');\n      },\n      error: (xhr) => {\n        // if error occured\n        $('#ep_profile_modal_verification').text('Error');\n        setTimeout(() => {\n          $('#ep_profile_modal_verification').text(oldText);\n        }, 2000);\n      },\n      success: (response) => {\n        $('#ep_profile_modal_verification').text(\n            'Verification email has been sent.'\n        );\n        $('#ep_profile_modal_verification').attr(\n            'data-verification-status',\n            'true'\n        );\n      },\n    });\n  };\n\n  const uploadImg = () => {\n    const userId = pad.getUserId();\n    const fd = new FormData();\n    const files = $('#profile_file_modal')[0].files[0];\n    fd.append('file', files);\n    if (!files) return;\n    $.ajax({\n      url: `/static/${clientVars.padId}/pluginfw/ep_profile_modal/upload/${userId}`,\n      type: 'post',\n      data: fd,\n      contentType: false,\n      processData: false,\n      beforeSend: () => {\n        // setting a timeout\n\n        helper.refreshLoadingImage(userId, clientVars.padId);\n      },\n      error: (xhr) => {\n        // if error occured\n        helper.refreshUserImage(userId, clientVars.padId);\n        $('#profile_modal_selected_image').attr(\n            'style',\n            (i, style) => style && style.replace(/background-image[^;]+;?/g, '')\n        );\n\n        switch (xhr.status) {\n          case 413:\n            $.gritter.add({\n              title: 'Error',\n              text: 'ep_profile_modal: image size is large.',\n              sticky: true,\n              // eslint-disable-next-line camelcase\n              class_name: 'error',\n            });\n          // Take action, referencing xhr.responseText as needed.\n        }\n      },\n      success: (response) => {\n        helper.refreshUserImage(userId, clientVars.padId);\n\n        $('#profile_modal_selected_image').attr(\n            'style',\n            (i, style) => style && style.replace(/background-image[^;]+;?/g, '')\n        );\n      },\n    });\n  };\n\n  const submitHandle = () => {\n    const userId = pad.getUserId();\n    const padId = pad.getPadId();\n    $('#ep_profile_formModal').removeClass('ep_profile_formModal_show');\n\n    uploadImg();\n\n    hideFormModalOverlay();\n\n    sendFormDataToServer();\n\n    const username = $('#ep_profile_modalForm_name').val();\n\n    helper.userLogin({\n      email: $('#ep_profile_modalForm_email').val(),\n      username,\n    });\n    setTimeout(() => {\n      helper.refreshUserImage(userId, padId);\n    }, 2200);\n    // sync profile section to up\n  };\n\n  const nextHandler = (currentFs, nextFs) => {\n    if (animating) return false;\n\n    const currentSection = currentFs.attr('data-section');\n    localStorage.setItem('formStatus', currentSection);\n    if (currentSection === 'name') {\n      if ($('#ep_profile_modalForm_name').val() === '') {\n        $('#ep_profile_modalForm_name').css({border: '1px solid red'});\n        return false;\n      }\n      const username = $('#ep_profile_modalForm_name').val();\n      $('#ep_profile_modalForm_name').css({border: '0px solid gray'});\n      // submit username once user input and press next\n      helper.userLogin({\n        username,\n      });\n      shared.loginByEmailAndUsernameWithoutValidation(username, '', false);\n    }\n    if (currentSection === 'email') {\n      const userEmail = $('#ep_profile_modalForm_email').val();\n      if (!shared.isEmail(userEmail) || userEmail === '') {\n        $('#ep_profile_modalForm_email').css({border: '1px solid red'});\n        return false;\n      }\n      const username = $('#ep_profile_modalForm_name').val();\n      shared.loginByEmailAndUsernameWithoutValidation(\n          username,\n          userEmail,\n          true\n      );\n      sendEmailVerification(userEmail, username);\n      $('#ep_profile_modalForm_email').css({border: '0px solid gray'});\n    }\n\n    if (currentSection === 'homepage') {\n      const userLink = $('#ep_profile_modal_homepage').val();\n      // console.log(shared.IsValid(userLink));\n      if (!shared.isValid(userLink) || userLink === '') {\n        $('#ep_profile_modal_homepage').css({border: '1px solid red'});\n        return false;\n      }\n      $('#ep_profile_modal_homepage').css({border: '0px solid gray'});\n      sendFormDataToServer();\n    }\n    // if (currentSection === 'push') {\n    //   helper.checkNotificationPermission();\n    // }\n\n    if (currentSection === 'push') {\n      $('#ep_profile_modalForm_push').val(true);\n      $('#ep_profile_modalForm_push').attr('checked', 'checked');\n      $('#ep_profile_modal_push').val('Yes');\n      sendFormDataToServer();\n    }\n\n    // if (currentSection == 'image') {\n    //   uploadImg();\n    // }\n\n    animating = true;\n    currentFs.hide();\n    if (nextFs.length) {\n      nextFs.show();\n\n      // focus handling\n      const nextSelection = nextFs.attr('data-section');\n      if (nextSelection === 'email') {\n        $('#ep_profile_modalForm_email').focus().select();\n      }\n      if (nextSelection === 'homepage') {\n        $('#ep_profile_modal_homepage').focus().select();\n      }\n      if (nextSelection === 'bio') {\n        $('#ep_profile_modalForm_about_yourself').focus().select();\n      }\n    } else {\n      // seems last fieldset\n      submitHandle();\n    }\n    animating = false;\n  };\n\n  $('#ep_profile_formModal_msform fieldset').on('keypress', (e) => {\n    if (e.keyCode === 13) {\n      // Cancel the default action on keypress event\n      e.preventDefault();\n      $(e.target).parent().find('.next').click();\n    }\n  });\n  $('.next').click(function () {\n    currentFs = $(this).parent();\n    nextFs = $(this).parent().next();\n    nextHandler(currentFs, nextFs);\n  });\n\n  $('.submit').click(() => {\n    submitHandle();\n    return false;\n  });\n  // upload image profile\n  $('#profile_file_modal').on('change', (e) => {\n    const files = $('#profile_file_modal')[0].files[0];\n\n    const url = URL.createObjectURL(files);\n    $('#profile_modal_selected_image').css({\n      'background-position': '50% 50%',\n      'background-image': `url(${url})`,\n      'background-repeat': 'no-repeat',\n      'background-size': '64px',\n    });\n  });\n};\n","import * as shared from '../shared';\n\nexport default (hooks, context, cb) => {\n  let socket;\n  const loc = document.location;\n  const port =\n    loc.port === '' ? (loc.protocol === 'https:' ? 443 : 80) : loc.port;\n  const url = `${loc.protocol}//${loc.hostname}:${port}/`;\n  const pathComponents = location.pathname.split('/');\n  // Strip admin/plugins\n  const baseURL = `${pathComponents\n      .slice(0, pathComponents.length - 2)\n      .join('/')}/`;\n  const resource = `${baseURL.substring(1)}socket.io`;\n\n  const room = `${url}pluginfw/admin/ep_profile_modal`;\n\n  switch (context) {\n    case 'admin/ep_profile_modal': {\n      // connect\n      socket = io.connect(room, {path: `${baseURL}socket.io`, resource});\n      socket.on('load-settings-result', (data) => {\n        shared.setFormData($('#settings-form'), data);\n      });\n\n      $('#save-settings').on('click', () => {\n        const data = shared.getFormData($('#settings-form'));\n        socket.emit('save-settings', data);\n        alert('Succesfully saved.');\n      });\n\n      socket.emit('load-settings');\n      break;\n    }\n    case 'admin/ep_profile_modal_analytics': {\n      socket = io.connect(room, {path: `${baseURL}socket.io`, resource});\n\n      socket.on('load-pads-result', (data) => {\n        console.log('load-pads', data);\n        $.each(data, (index, value) => {\n          $('#pads').append(`<option value=\"${value}\">${value}</option>`);\n        });\n      });\n      socket.on('load-analytics-result', (data) => {\n        console.log('load-analytics', data);\n        $.each(data.pad_users_data, (index, value) => {\n          if (value.userId) {\n            $('#users').append(`\n              <tr style=\"height: 0;\">\n                <td>${value.email || value.userId}</td>\n                <td>${value.username}</td>\n                <td>${value.createDate}</td>\n                <td>${value.lastSeenDate}</td>\n                <td>${value.verifiedDate || '-'}</td>\n                <td>${value.verified ? 'Verified' : 'unconfirmed'}</td>\n              </tr>\n              `);\n          }\n        });\n      });\n\n      $('#pads').on('change', function () {\n        socket.emit('load-analytics', {pad: this.value});\n      });\n\n      socket.emit('load-pads');\n      break;\n    }\n    default: {\n      return [];\n    }\n  }\n};\n","import * as profileForm from './profileForm/main';\nimport * as usersProfileSection from './userProfileSection/userProfileSection.js';\nimport * as contributors from './contributors/contributors';\n\nexport default (hook, context) => {\n  const bindEvent = (element, eventName, eventHandler) => {\n    if (element.addEventListener) {\n      element.addEventListener(eventName, eventHandler, false);\n    } else if (element.attachEvent) {\n      element.attachEvent(`on${eventName}`, eventHandler);\n    }\n  };\n\n  bindEvent(window, 'message', (e) => {\n    const eventName = e.data.eventName;\n    const data = e.data.data;\n\n    if (eventName === 'showEtherpadModal') {\n      profileForm.showModal();\n    }\n    if (eventName === 'showProfileDetailModal') {\n      $('#usersIconList').trigger('avatarClick', data.userId);\n    }\n  });\n\n  const userId = pad.getUserId();\n  // if (!window.matchMedia('(max-width: 720px)').matches) {\n  profileForm.initModal(clientVars);\n  // if (clientVars.ep_profile_modal.form_passed !== true) {\n  //   profileForm.showModal();\n  // }\n  if (localStorage.getItem('formPassed') !== 'yes') profileForm.allEventListener();\n  //   profileForm.showModal();\n\n  // / user profile section\n  usersProfileSection.initiate(clientVars);\n  // / user profile section\n\n  let modal = $('#ep_profile_modal_script').tmpl(clientVars);\n  $('body').append(modal);\n  // /\n  modal = $('#ep_profile_modal_user_list_script').tmpl(clientVars);\n  $('body').append(modal);\n  // /general\n  modal = $('#ep_profile_modal_general_script').tmpl();\n  $('body').append(modal);\n  // template generate\n\n  const style = `\n      background : url(/static/getUserProfileImage/${userId}/${clientVars.padId}) no-repeat 50% 50%;\n      background-size :32px\n    `;\n\n  const onlineUsers = pad.collabClient.getConnectedUsers();\n  const usersListHTML = contributors.createHTMLforUserList(\n      clientVars.ep_profile_modal.contributed_authors_count,\n      onlineUsers,\n      clientVars.padId,\n      clientVars.ep_profile_modal.verified\n  );\n\n  if (!$('body').hasClass('mobileView')) {\n    if ($('#pad_title').length === 0) {\n      $('body').prepend(`\n          <div id='pad_title'>\n            <div class=\"title_container\">\n              <span contenteditable style=\"color:#000\" id='title'>Loading...</span>\n            </div>\n            <button id='save_title'></button>\n          </div>\n        `);\n    }\n    $('#pad_title').append(`\n        <div class='ep_profile_modal_header'>\n          <div class='userlist' id='userlist'>\n          ${usersListHTML}\n          </div>\n          <div class='ep-profile-button' id='ep-profile-button'>\n          <div id='ep-profile-image' style='${style}' /></div>\n        </div>\n      `);\n  } else {\n    // if mobile\n    $('#mainHeader .inlineAvatar').append(`\n        <div class='ep_profile_modal_header'>\n          <div class='ep-profile-button' id='ep-profile-button'>\n          <div id='ep-profile-image' style='${style}' /></div>\n        </div>\n      `);\n  }\n\n  if (clientVars.ep_profile_modal.userStatus === '2') {\n    window.userStatus = 'login';\n  } else {\n    window.userStatus = 'out';\n  }\n  // We were telling to server that we\n  // are ready to get data that due to large data\n  // need to be request base over HTTP + just for analytics\n  const message = {\n    type: 'ep_profile_modal',\n    action: 'ep_profile_modal_ready',\n    userId,\n    padId: clientVars.padId,\n    data: clientVars.ep_profile_modal,\n  };\n\n  pad.collabClient.sendMessage(message);\n\n  if (clientVars.ep_profile_modal.userName === 'Anonymous') {\n    pad.collabClient.updateUserInfo({\n      userId,\n      name: 'Anonymous',\n      colorId: '#b4b39a',\n    });\n  }\n\n  return [];\n};\n","import * as contributors from './contributors/contributors';\nimport * as helper from './helper';\nimport * as syncData from './syncData';\n\nexport const handleClientMessage_USER_NEWINFO = (hook, context) => {\n  const padId = pad.getPadId();\n\n  contributors.increaseUserFromList(context.payload.userId, padId);\n  return [];\n};\n\nexport const handleClientMessage_USER_LEAVE = (hook, context) => {\n  const padId = pad.getPadId();\n\n  contributors.decreaseUserFromList(context.payload.userId, padId);\n  return [];\n};\n\nexport const handleClientMessage_CUSTOM = (hook, context, cb) => {\n  const currentUserId = pad.getUserId();\n\n  if (context.payload.action === 'totalUserHasBeenChanged') {\n    const totalUserCount = context.payload.totalUserCount;\n    $('#userlist_count').text(totalUserCount);\n  }\n\n  if (context.payload.action === 'EP_PROFILE_USER_IMAGE_CHANGE') {\n    // when user A change image and user B want to know\n    helper.refreshGeneralImage(context.payload.userId, context.payload.padId);\n  }\n\n  if (context.payload.action === 'EP_PROFILE_USER_LOGOUT_UPDATE') {\n    const imageUrl = `/static/getUserProfileImage/${context.payload.userId}/${context.payload.padId\n    }?t=${new Date().getTime()}`;\n\n    if (currentUserId === context.payload.userId) {\n      helper.refreshUserImage(currentUserId, context.payload.padId);\n      helper.logoutCssFix(currentUserId);\n    } else {\n      helper.refreshGeneralImage(\n          context.payload.userId,\n          context.payload.padId\n      );\n    }\n\n    syncData.resetGeneralFields(context.payload.userId);\n\n    // making user as anonymous\n    const onlineAnonymousSelector = contributors.isThereOnlineAnonymous();\n    if (onlineAnonymousSelector) {\n      contributors.increaseToOnlineAnonymous(\n          onlineAnonymousSelector,\n          context.payload.userId\n      );\n    } else {\n      contributors.createOnlineAnonymousElement(\n          context.payload.userId,\n          'Anonymous',\n          imageUrl,\n          {}\n      );\n    }\n\n    contributors.removeUserElementInUserList(context.payload.userId);\n  }\n\n  if (context.payload.action === 'EP_PROFILE_USER_LOGIN_UPDATE') {\n    // ///////////////// related to user list when user has been loginned\n    const onlineAnonymousSelector = contributors.isThereOnlineAnonymous();\n    if (context.payload.userName === 'Anonymous') {\n      if (onlineAnonymousSelector) {\n        contributors.increaseToOnlineAnonymous(\n            onlineAnonymousSelector,\n            context.payload.userId\n        );\n      } else {\n        contributors.createOnlineAnonymousElement(\n            context.payload.userId,\n            context.payload.userName,\n            context.payload.img,\n            context.payload.user\n        );\n      }\n\n      contributors.removeUserElementInUserList(context.payload.userId);\n    } else {\n      if (onlineAnonymousSelector) {\n        if (\n          contributors.checkUserExistInOnlineAnonymous(\n              onlineAnonymousSelector,\n              context.payload.userId\n          )\n        ) {\n          contributors.decreaseFromOnlineAnonymous(\n              onlineAnonymousSelector,\n              context.payload.userId\n          );\n        }\n      }\n      contributors.createOnlineUserElementInUserList(\n          context.payload.userId,\n          context.payload.userName,\n          context.payload.img,\n          currentUserId,\n          context.payload.user\n      );\n    }\n\n    // change owner loginned img at top of page\n    if (currentUserId === context.payload.userId) {\n      helper.refreshUserImage(currentUserId, context.payload.padId);\n      syncData.syncAllFormsData(context.payload.userId, context.payload.user);\n\n      // $(\"#ep_profile_modal_section_info_name\").text(context.payload.userName);\n    } else {\n      helper.refreshGeneralImage(\n          context.payload.userId,\n          context.payload.padId\n      );\n      syncData.syncGeneralFormsData(\n          context.payload.userId,\n          context.payload.user\n      );\n    }\n  }\n\n  return [];\n};\n","import * as shared from './shared';\n\nexport const syncAllFormsData = (userId, data) => {\n  if (data === undefined) return;\n  // users List\n  const userSelector = $(\n      `.ep_profile_user_row[data-id=\"user_list_${userId}\"]`\n  );\n  if (userSelector.length) {\n    const usernameBox = userSelector\n        .children('.ep_profile_user_list_profile_userDesc')\n        .children('.ep_profile_user_list_username');\n    usernameBox\n        .children('.ep_profile_user_list_username_text')\n        .text(data.username);\n\n    userSelector\n        .children('.ep_profile_user_list_profile_userDesc')\n        .children('.ep_profile_user_list_profile_desc')\n        .text(data.about);\n    if (data.homepage) {\n      const homepageElem = usernameBox.children(\n          '.ep_profile_contributor_link_container'\n      );\n      homepageElem.attr({href: shared.getValidUrl(data.homepage)});\n    }\n    usernameBox.children('.ep_profile_contributor_status').text('Online');\n  }\n  $('#ep_profile_modal-username').val(data.username);\n  $('#ep_profile_modal-about').val(data.about);\n  $('#ep_profile_modal-homepage').val(data.homepage);\n  $('#ep_profile_modal-email').val(data.email);\n  if (data.verified === true) {\n    $('#ep_profile_modal_verification').attr(\n        'data-verification-status',\n        'true'\n    );\n    $('#ep_profile_modal_verification').text('Verified');\n  } else {\n    $('#ep_profile_modal_verification').attr(\n        'data-verification-status',\n        'false'\n    );\n    $('#ep_profile_modal_verification').text('Send verification email');\n  }\n  // if(data.push_notification == false)\n  //     $(\"#ep_profile_modal_push_notification\").attr('checked','')\n  // else\n  //     $(\"#ep_profile_modal_push_notification\").attr('checked','checked')\n\n  // profile modal\n};\n\nexport const syncGeneralFormsData = (userId, data) => {\n  const userSelector = $(\n      `.ep_profile_user_row[data-id=\"user_list_${userId}\"]`\n  );\n  if (userSelector.length) {\n    const usernameBox = userSelector\n        .children('.ep_profile_user_list_profile_userDesc')\n        .children('.ep_profile_user_list_username');\n    usernameBox\n        .children('.ep_profile_user_list_username_text')\n        .text(data.username);\n\n    userSelector\n        .children('.ep_profile_user_list_profile_userDesc')\n        .children('.ep_profile_user_list_profile_desc')\n        .text(data.about);\n\n    const homepageElem = usernameBox.children(\n        '.ep_profile_contributor_link_container'\n    );\n    homepageElem.attr({href: shared.getValidUrl(data.homepage)});\n\n    usernameBox.children('.ep_profile_contributor_status').text('Online');\n  }\n};\n\nexport const resetProfileModalFields = () => {\n  $('#ep_profile_modal-username').val('');\n  $('#ep_profile_modal-about').val('');\n  $('#ep_profile_modal-homepage').val('');\n  $('#ep_profile_modal-email').val('');\n\n  $('#ep_profile_modalForm_name').val('');\n  $('#ep_profile_modalForm_email').val('');\n  $('#ep_profile_modal_homepage').val('');\n  $('#ep_profile_modalForm_about_yourself').val('');\n};\n\nexport const resetGeneralFields = (userId) => {\n  const userSelector = $(\n      `.ep_profile_user_row[data-id=\"user_list_${userId}\"]`\n  );\n  if (userSelector.length) {\n    const usernameBox = userSelector\n        .children('.ep_profile_user_list_profile_userDesc')\n        .children('.ep_profile_user_list_username');\n    usernameBox.children('.ep_profile_user_list_username_text').text('');\n    userSelector\n        .children('.ep_profile_user_list_profile_userDesc')\n        .children('.ep_profile_user_list_profile_desc')\n        .text('');\n    const homepageElem = usernameBox.children(\n        '.ep_profile_contributor_link_container'\n    );\n    homepageElem.attr({href: ''});\n    usernameBox.children('.ep_profile_contributor_status').text('');\n  }\n};\n","import * as shared from './shared';\nimport * as helper from './helper';\nimport * as syncData from './syncData';\nimport {initiateListeners} from './userProfileSection/userProfileSection';\nimport * as contributors from './contributors/contributors';\nimport * as profileForm from './profileForm/main';\n\nconst __LOGOUT = '1';\n\nexport default (hook, context) => {\n  initiateListeners();\n\n  $('#ep_profile_modalForm_push').on('change', (e) => {\n    const elem = $('#ep_profile_modalForm_push');\n    const checked = elem.is(':checked');\n    elem.attr('checked', checked);\n    elem.val(checked);\n  });\n\n  $('#ep_profile_modal_save').on('click', () => {\n    const userId = pad.getUserId();\n    const padId = pad.getPadId();\n    const username = $('#ep_profile_modal-username');\n    // validations\n    if (username.val() === '') {\n      username.css({border: '1px solid red'});\n      return false;\n    }\n    username.css({border: '0'});\n    // validations\n\n    const $form = $('#ep_profile_modal_one');\n    const data = shared.getFormData($form);\n\n\n    // send to ep_push_notification\n    if (data.ep_profile_modalForm_push) {\n      const event = new CustomEvent('ep_push_notification',\n          {detail: {eventName: 'checkPermission'}});\n      // Dispatch/Trigger/Fire the event\n      window.dispatchEvent(event);\n    }\n\n\n    const message = {\n      type: 'ep_profile_modal',\n      action: 'ep_profile_modal_info',\n      userId,\n      data,\n      padId,\n    };\n    pad.collabClient.sendMessage(message); // Send the chat position message to the server\n    pad.collabClient.updateUserInfo({\n      userId: padId,\n      name: username.val(),\n      colorId: '#b4b39a',\n    });\n\n    if (window.userStatus === 'login') {\n      if ($('#ep_profile_modal').hasClass('ep_profile_modal-show')) {\n        $('#ep_profile_modal').removeClass('ep_profile_modal-show');\n        shared.hideGeneralOverlay();\n      } else {\n        $('#ep_profile_modal').addClass('ep_profile_modal-show');\n\n        $('#online_ep_profile_modal_status').show();\n        $('#offline_ep_profile_modal_status').hide();\n\n        shared.showGeneralOverlay();\n      }\n    }\n  });\n\n  $('#userlist_count').on('click', () => {\n    const page = $('#ep_profile_modal_user_list').attr('data-page') || 1;\n    const pageLoaded =\n      $('#ep_profile_modal_user_list').attr('data-pageLoaded') || false;\n    const onlineListSelector = $('#ep_profile_user_list_container');\n\n    if (pageLoaded !== 'true') {\n      $.ajax({\n        url: `/static/${pad.getPadId()}/pluginfw/ep_profile_modal/getContributors/${page}/`,\n        type: 'get',\n        data: {},\n        contentType: false,\n        processData: false,\n        beforeSend: () => {\n          // setting a timeout\n          // $('#contributorsLoading').show();\n          $('#ep_profile_user_list_container').css({display: 'none'});\n          $('#ep_profile_modal_load_more_contributors').css({\n            display: 'none',\n          });\n          onlineListSelector.css({display: 'none'});\n        },\n        error: (xhr) => {\n          // if error occured\n          $('#contributorsLoading').css({display: 'none'});\n          onlineListSelector.css({display: 'block'});\n        },\n        success: (response) => {\n          onlineListSelector.css({display: 'block'});\n          $('#contributorsLoading').css({display: 'none'});\n          $('#ep_profile_user_list_container').css({display: 'block'});\n          $('#ep_profile_modal_user_list').attr('data-pageLoaded', 'true');\n          const onlineUsers = pad.collabClient.getConnectedUsers();\n          contributors.manageOnlineOfflineUsers(\n              response.data,\n              onlineUsers,\n              pad.getUserId(),\n              response.lastPage\n          );\n        },\n      });\n    }\n  });\n\n  $('#ep_profile_modal_load_more_contributors').on('click', () => {\n    let page = $('#ep_profile_modal_user_list').attr('data-page') || 1;\n    page++;\n    $.ajax({\n      url: `/static/${pad.getPadId()}/pluginfw/ep_profile_modal/getContributors/${page}/`,\n      type: 'get',\n      data: {},\n      contentType: false,\n      processData: false,\n      beforeSend: () => {\n        // setting a timeout\n        $('#loadMoreLoading').show();\n        $('#ep_profile_modal_load_more_contributors').css({\n          display: 'none',\n        });\n      },\n      error: (xhr) => {\n        // if error occured\n        $('#loadMoreLoading').hide();\n        $('#ep_profile_modal_load_more_contributors').css({\n          display: 'block',\n        });\n      },\n      success: (response) => {\n        $('#ep_profile_modal_load_more_contributors').css({\n          display: 'block',\n        });\n        $('#loadMoreLoading').hide();\n        $('#ep_profile_modal_user_list').attr('data-page', page);\n        const onlineUsers = pad.collabClient.getConnectedUsers();\n        contributors.manageOnlineOfflineUsers(\n            response.data,\n            onlineUsers,\n            pad.getUserId(),\n            response.lastPage\n        );\n      },\n    });\n  });\n\n  $('#userlist_count,#ep_profile_modal_user_list_close').on('click', () => {\n    if ($('#ep_profile_modal_user_list').hasClass('ep_profile_modal-show')) {\n      $('#ep_profile_modal_user_list').removeClass('ep_profile_modal-show');\n      shared.hideGeneralOverlay();\n    } else {\n      shared.showGeneralOverlay();\n      $('#ep_profile_modal_user_list').addClass('ep_profile_modal-show');\n    }\n  });\n\n  $('#ep_profile_modal_verification').on('click', function () {\n    const verificationStatus = $(this).attr('data-verification-status');\n    const oldText = $(this).text();\n    if (verificationStatus !== 'true') {\n      $.ajax({\n        url: `/static/${pad.getPadId()\n        }/pluginfw/ep_profile_modal/sendVerificationEmail/${pad.getUserId()}/null/null`,\n        type: 'get',\n        data: {},\n        contentType: false,\n        processData: false,\n        beforeSend: () => {\n          // setting a timeout\n          $('#ep_profile_modal_verification').text('Sending...');\n        },\n        error: (xhr) => {\n          // if error occured\n          $('#ep_profile_modal_verification').text('Error');\n          setTimeout(() => {\n            $('#ep_profile_modal_verification').text(oldText);\n          }, 2000);\n        },\n        success: (response) => {\n          $('#ep_profile_modal_verification').text(\n              'Verification email has been sent.'\n          );\n          $('#ep_profile_modal_verification').attr(\n              'data-verification-status',\n              'true'\n          );\n        },\n      });\n    }\n    return false;\n  });\n  $('#ep_profile_modal_share').on('click', () => {\n    const dummy = document.createElement('input');\n    const text = window.location.href;\n\n    document.body.appendChild(dummy);\n    dummy.value = text;\n    dummy.select();\n    document.execCommand('copy');\n    document.body.removeChild(dummy);\n    $.gritter.add({\n      text: 'Link copied to clipboard',\n    });\n  });\n\n  $('#ep-profile-button').on('click', () => {\n    if (window.userStatus === 'login') {\n      if ($('#ep_profile_modal').hasClass('ep_profile_modal-show')) {\n        $('#ep_profile_modal').removeClass('ep_profile_modal-show');\n      } else {\n        $('#ep_profile_modal').addClass('ep_profile_modal-show');\n        $('#online_ep_profile_modal_status').show();\n        $('#offline_ep_profile_modal_status').hide();\n        shared.showGeneralOverlay();\n      }\n    } else {\n      profileForm.resetModal();\n      profileForm.showModal();\n    }\n  });\n\n  $('#ep_profile_modal_close').on('click', () => {\n    if ($('#ep_profile_modal').hasClass('ep_profile_modal-show')) {\n      $('#ep_profile_modal').removeClass('ep_profile_modal-show');\n      shared.hideGeneralOverlay();\n    } else {\n      shared.showGeneralOverlay();\n      $('#ep_profile_modal').addClass('ep_profile_modal-show');\n    }\n  });\n  $('#ep_profile_modal_close_ask').on('click', () => {\n    $('#ep_profile_modal_ask').hasClass('ep_profile_modal-show')\n      ? $('#ep_profile_modal_ask').removeClass('ep_profile_modal-show')\n      : $('#ep_profile_modal_ask').addClass('ep_profile_modal-show');\n  });\n\n  $('#ep_profile_modal_signout').on('click', () => {\n    profileForm.resetModal();\n\n    const userId = pad.getUserId();\n    const padId = pad.getPadId();\n    localStorage.setItem('formStatus', '');\n    clientVars.ep_profile_modal.userStatus = __LOGOUT;\n\n    window.userStatus = 'out';\n    const message = {\n      type: 'ep_profile_modal',\n      action: 'ep_profile_modal_logout',\n      email: $('#ep_profile_hidden_email').val(),\n      userId,\n      padId,\n    };\n    clientVars.ep_profile_modal.userStatus = __LOGOUT;\n    pad.collabClient.sendMessage(message); // Send the chat position message to the server\n    $('#ep_profile_modal').removeClass('ep_profile_modal-show');\n    $('#online_ep_profile_modal_status').hide();\n    $('#offline_ep_profile_modal_status').show();\n    syncData.resetProfileModalFields();\n    shared.hideGeneralOverlay();\n    $(`.avatar[data-id=\"user_${userId}\"]`).attr({style: ''});\n    helper.userLogout();\n  });\n\n  // upload image profile\n  $('#profile_file').on('change', (e) => {\n    const userId = pad.getUserId();\n    const fd = new FormData();\n    const files = $('#profile_file')[0].files[0];\n    fd.append('file', files);\n    if (!files) return;\n    $.ajax({\n      url: `/static/${clientVars.padId}/pluginfw/ep_profile_modal/upload/${userId}`,\n      type: 'post',\n      data: fd,\n      contentType: false,\n      processData: false,\n      beforeSend: () => {\n        // setting a timeout\n        helper.refreshLoadingImage(userId, clientVars.padId);\n      },\n      error: (xhr) => {\n        // if error occured\n        helper.refreshUserImage(userId, clientVars.padId);\n      },\n      success: (response) => {\n        helper.refreshUserImage(userId, clientVars.padId);\n      },\n    });\n  });\n\n  $('#ep_profile_modal_submit').on('click', () => {\n    const username = $('#ep_profile_modal_username').val();\n    const email = $('#ep_profile_modal_email').val();\n\n    shared.loginByEmailAndUsername(username, email);\n  });\n\n  $('#ep_profile_modal_login').on('click', () => {\n    const username = $('#ep_profile_modal-username').val();\n    const email = $('#ep_profile_modal-email').val();\n\n    shared.loginByEmailAndUsername(username, email);\n    $('#ep_profile_modal').removeClass('ep_profile_modal-show');\n  });\n\n  $('#ep_profile_general_overlay').on('click', () => {\n    shared.hideGeneralOverlay();\n  });\n\n  return [];\n};\n"],"names":["userLogin","data","window","userStatus","clientVars","ep_profile_modal","pad","collabClient","updateUserInfo","userId","getUserId","name","username","colorId","refreshUserImage","padId","imageUrl","Date","getTime","avatar","$","length","css","userSelector","children","rocketChatOnlineUser","refreshLoadingImage","refreshGeneralImage","loginByEmailAndUsernameWithoutValidation","email","suggestData","message","type","action","getPadId","sendMessage","isEmail","test","loginByEmailAndUsername","focus","addClass","removeClass","helper.userLogin","show","hide","getFormData","$form","unindexedArray","serializeArray","indexedArray","map","n","i","value","showGeneralOverlay","display","hideGeneralOverlay","getValidUrl","url","newUrl","decodeURIComponent","trim","replace","getCustomDate","date","console","log","split","initiateListeners","avatarListerner","ajax","contentType","processData","beforeSend","text","shared.showGeneralOverlay","error","xhr","shared.hideGeneralOverlay","success","response","user","about","homepage","attr","href","shared.getValidUrl","target","on","e","userIdParam","indexOf","this","getHtmlOfUsersList","img","anonymousHandler","seenStatus","style","undefined","increaseToOnlineAnonymous","selectorOn","anonymouseCount","idsDataArray","push","join","newAnonymouseCount","parseInt","manageOnlineOfflineUsers","allUsersList","onlineUsers","currentUserId","lastPage","onlineListSelector","offlineListSelector","each","key","grep","userName","userListHtml","append","prependTo","appendTo","lastSeenDate","shared.getCustomDate","offlinesDateSelector","selectorOff","idsDataOffArray","selectorOfflinesDate","decreaseFromOnlineAnonymous","remove","isThereOnlineAnonymous","selector","createOnlineAnonymousElement","decreaseUserFromList","animate","opacity","selectorUser","userElement","insertBefore","prepend","moveOnlineUserToOffline","idsData","increaseToOfflineAnonymous","createOfflineAnonymousElement","removeUserElementInUserList","showModal","setTimeout","handleOnCloseOverlay","msg","localStorage","setItem","innerdocbody","contents","find","off","removeEventListener","ep_profile_modalForm_name","includes","getItem","ep_profile_modalForm_about_yourself","ep_profile_modalForm_homepage","messageChatText","time","event","CustomEvent","detail","eventName","title","body","dispatchEvent","hideFormModalOverlay","resetModal","index","initModal","modal","tmpl","currentFs","nextFs","previousFs","animating","click","border","parent","next","prev","helper.refreshLoadingImage","helper.refreshUserImage","sendFormDataToServer","ep_profile_modalForm_push","submitHandle","fd","FormData","files","status","gritter","add","sticky","class_name","uploadImg","val","nextHandler","currentSection","shared.loginByEmailAndUsernameWithoutValidation","userEmail","shared.isEmail","oldText","sendEmailVerification","userLink","nextSelection","select","keyCode","preventDefault","URL","createObjectURL","exports","aceInitialized","hook","context","element","eventHandler","profileForm.showModal","trigger","addEventListener","attachEvent","profileForm.initModal","which","profileForm.allEventListener","usersProfileSection.initiate","getConnectedUsers","usersListHTML","total","online","userVerify","html","borderStyle","reverse","contributors.createHTMLforUserList","contributed_authors_count","verified","hasClass","documentReady","hooks","cb","socket","loc","document","location","port","protocol","hostname","pathComponents","pathname","baseURL","slice","resource","substring","room","io","connect","path","shared.getFormData","emit","alert","pad_users_data","createDate","verifiedDate","handleClientMessage_CUSTOM","payload","totalUserCount","helper.refreshGeneralImage","margin","helper.logoutCssFix","usernameBox","syncData.resetGeneralFields","onlineAnonymousSelector","contributors.isThereOnlineAnonymous","contributors.increaseToOnlineAnonymous","contributors.createOnlineAnonymousElement","contributors.removeUserElementInUserList","contributors.decreaseFromOnlineAnonymous","titleOfContributors","insertAfter","contributors.createOnlineUserElementInUserList","syncData.syncAllFormsData","syncData.syncGeneralFormsData","handleClientMessage_USER_LEAVE","contributors.decreaseUserFromList","handleClientMessage_USER_NEWINFO","$image","slideDown","contributors.increaseUserFromList","postAceInit","elem","checked","is","page","pageLoaded","contributors.manageOnlineOfflineUsers","verificationStatus","dummy","createElement","appendChild","execCommand","removeChild","profileForm.resetModal","shared.loginByEmailAndUsername"],"mappings":"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"}